[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.17.1","content-config-digest","5fd85282c9ab9ac2","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://roothytx.github.io\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false}}","utilities",["Map",11,12,55,56,103,104,143,144,206,207,263,264,326,327],"utility-belt",{"id":11,"data":13,"body":22,"filePath":23,"digest":24,"rendered":25,"legacyId":54},{"title":14,"description":15,"category":16,"tags":17,"created":21},"Utility Belt","Main utilities hub with overview of all available utilities","general",[18,19,20],"overview","navigation","help",["Date","2024-11-10T00:00:00.000Z"],"# Utility Belt\n\nn- iffy, uh, blicky got the stiffy, uh\nGot the blicky, uh, drum, it hold fifty, uh\n\n## Available Utilities\n\n### System Utilities\n- **proxmox-lxc-boot** - Initial boot for Proxmox LXC containers\n- **docker-install** - Complete Docker installation script\n- **rootless-docker** - Secure rootless Docker setup\n\n### Security & Networking\n- **certificate-generation** - SSL certificate generation with Certbot\n\n## Navigation Commands\n\nUse the terminal commands to navigate and access utilities:\n\n```bash\n# List available directories\nls\n\n# Navigate to utilities\ncd utilities\n\n# List utilities\nls\n\n# Open a utility\ncat utility-name\n\n# Get help\nhelp\n```\n\n## Quick Access\n\n- **ESC** - Toggle terminal input focus\n- **Backspace** - Go back from utility view\n- **Arrow keys** - Navigate directory items\n- **Enter** - Select/activate items\n\nAll utilities are designed to be practical, production-ready scripts that can be used directly in your projects.","src/content/utilities/utility-belt.md","09c280300a6de8de",{"html":26,"metadata":27},"\u003Ch1 id=\"utility-belt\">Utility Belt\u003C/h1>\n\u003Cp>n- iffy, uh, blicky got the stiffy, uh\nGot the blicky, uh, drum, it hold fifty, uh\u003C/p>\n\u003Ch2 id=\"available-utilities\">Available Utilities\u003C/h2>\n\u003Ch3 id=\"system-utilities\">System Utilities\u003C/h3>\n\u003Cul>\n\u003Cli>\u003Cstrong>proxmox-lxc-boot\u003C/strong> - Initial boot for Proxmox LXC containers\u003C/li>\n\u003Cli>\u003Cstrong>docker-install\u003C/strong> - Complete Docker installation script\u003C/li>\n\u003Cli>\u003Cstrong>rootless-docker\u003C/strong> - Secure rootless Docker setup\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"security--networking\">Security &#x26; Networking\u003C/h3>\n\u003Cul>\n\u003Cli>\u003Cstrong>certificate-generation\u003C/strong> - SSL certificate generation with Certbot\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"navigation-commands\">Navigation Commands\u003C/h2>\n\u003Cp>Use the terminal commands to navigate and access utilities:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># List available directories\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">ls\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Navigate to utilities\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">cd\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> utilities\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># List utilities\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">ls\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Open a utility\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cat\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> utility-name\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Get help\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">help\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"quick-access\">Quick Access\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Cstrong>ESC\u003C/strong> - Toggle terminal input focus\u003C/li>\n\u003Cli>\u003Cstrong>Backspace\u003C/strong> - Go back from utility view\u003C/li>\n\u003Cli>\u003Cstrong>Arrow keys\u003C/strong> - Navigate directory items\u003C/li>\n\u003Cli>\u003Cstrong>Enter\u003C/strong> - Select/activate items\u003C/li>\n\u003C/ul>\n\u003Cp>All utilities are designed to be practical, production-ready scripts that can be used directly in your projects.\u003C/p>",{"headings":28,"localImagePaths":48,"remoteImagePaths":49,"frontmatter":50,"imagePaths":53},[29,31,35,39,42,45],{"depth":30,"slug":11,"text":14},1,{"depth":32,"slug":33,"text":34},2,"available-utilities","Available Utilities",{"depth":36,"slug":37,"text":38},3,"system-utilities","System Utilities",{"depth":36,"slug":40,"text":41},"security--networking","Security & Networking",{"depth":32,"slug":43,"text":44},"navigation-commands","Navigation Commands",{"depth":32,"slug":46,"text":47},"quick-access","Quick Access",[],[],{"title":14,"description":15,"category":16,"tags":51,"created":52},[18,19,20],["Date","2024-11-10T00:00:00.000Z"],[],"utility-belt.md","proxmox-lxc-boot",{"id":55,"data":57,"body":68,"filePath":69,"digest":70,"rendered":71,"legacyId":102},{"title":58,"description":59,"category":60,"tags":61,"created":67},"Proxmox LXC Initial Boot","Automated Proxmox LXC container creation with Ubuntu 24.04 and Tailscale VPN setup","system",[62,63,64,65,66],"proxmox","lxc","tailscale","ubuntu","automation",["Date","2024-11-10T00:00:00.000Z"],"# Proxmox LXC Initial Boot Script\n\nThis script automates the creation and initial setup of a Proxmox LXC container with Ubuntu 24.04, including Tailscale VPN setup for secure remote access.\n\n## Script\n\n```bash\n#!/bin/bash\n\n# Generate next available container ID\nnextid=$(ls /etc/pve/lxc/*.conf 2>/dev/null | \\\n         sed 's/.*\\///;s/\\.conf//' | \\\n         sort -n | tail -n1 | \\\n         awk '{print $1+1}')\nlast_digit=\"${nextid: -1}\"\nctname=\"ctfd-${last_digit}\"\nctt=\"local:vztmpl/ubuntu-24.04-standard_24.04-2_amd64.tar.zst\"\ncts=\"local-lvm\"\n\n# Container specifications\nmemory=1024\nswap=2048\nstorage_space=20\n\n# Create the container\npct create ${nextid} ${ctt} \\\n  --hostname=${ctname} \\\n  --nameserver=1.1.1.1 \\\n  --searchdomain=1.0.0.1 \\\n  --password=${ctname} \\\n  --ostype=ubuntu --unprivileged=0 --features nesting=1 \\\n  --net0 name=eth0,bridge=vmbr0,ip=dhcp \\\n  --arch=amd64 --swap=${swap} --memory=${memory} \\\n  --storage=${cts}\n\n# Resize storage and start container\npct resize ${nextid} rootfs +$((storage_space-4))G\npct start ${nextid}\npct enter ${nextid}\n\n# Update system and install Tailscale\napt-get update && apt-get upgrade -y\napt-get install curl -y\ncurl -fsSL https://tailscale.com/install.sh | sh\nsystemctl start tailscaled\ntailscale up\n```\n\n## Usage Notes\n\n```bash\n# Run as root on Proxmox host\nbash proxmox-lxc-boot.sh\n```\n\n### What the script does:\n- Finds the next available container ID automatically\n- Creates Ubuntu 24.04 LXC container with specified resources\n- Configures network with DHCP and custom nameservers\n- Sets up storage with specified space allocation\n- Installs and configures Tailscale VPN for secure remote access\n- Container password is automatically set to container name\n\n### Features:\n- **Automatic ID generation** - No manual container ID management\n- **Ubuntu 24.04** - Latest stable Ubuntu LTS\n- **Tailscale integration** - Secure mesh VPN out of the box\n- **Resource optimization** - Balanced memory, swap, and storage\n- **Nesting enabled** - Allows running Docker inside LXC\n\n### Prerequisites:\n- Proxmox VE installed and configured\n- Network bridge (vmbr0) configured\n- Storage (local-lvm) available\n- Root access on Proxmox host\n\n### Customization:\n- Modify `memory`, `swap`, and `storage_space` variables as needed\n- Change `ctname` pattern for different naming conventions\n- Adjust network bridge if using different network configuration","src/content/utilities/proxmox-lxc-boot.md","e2241e93005702fa",{"html":72,"metadata":73},"\u003Ch1 id=\"proxmox-lxc-initial-boot-script\">Proxmox LXC Initial Boot Script\u003C/h1>\n\u003Cp>This script automates the creation and initial setup of a Proxmox LXC container with Ubuntu 24.04, including Tailscale VPN setup for secure remote access.\u003C/p>\n\u003Ch2 id=\"script\">Script\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#!/bin/bash\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Generate next available container ID\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">nextid\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">$(\u003C/span>\u003Cspan style=\"color:#B392F0\">ls\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/pve/lxc/\u003C/span>\u003Cspan style=\"color:#79B8FF\">*\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.conf\u003C/span>\u003Cspan style=\"color:#F97583\"> 2>\u003C/span>\u003Cspan style=\"color:#9ECBFF\">/dev/null\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">         sed\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 's/.*\\///;s/\\.conf//'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">         sort\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -n\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> tail\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -n1\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">         awk\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '{print $1+1}'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">last_digit\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">nextid\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> -1\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">ctname\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"ctfd-${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">last_digit\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">ctt\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"local:vztmpl/ubuntu-24.04-standard_24.04-2_amd64.tar.zst\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">cts\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"local-lvm\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Container specifications\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">memory\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">1024\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">swap\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">2048\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">storage_space\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">20\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Create the container\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">pct\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> create\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ${nextid} ${ctt} \u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --hostname=${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">ctname\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --nameserver=1.1.1.1\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --searchdomain=1.0.0.1\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --password=${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">ctname\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --ostype=ubuntu\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --unprivileged=0\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --features\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> nesting=\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --net0\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> name=eth0,bridge=vmbr0,ip=dhcp\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --arch=amd64\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --swap=${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">swap\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --memory=${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">memory\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --storage=${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">cts\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Resize storage and start container\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">pct\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> resize\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ${nextid} \u003C/span>\u003Cspan style=\"color:#9ECBFF\">rootfs\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\">$((\u003C/span>\u003Cspan style=\"color:#B392F0\">storage_space-4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003Cspan style=\"color:#9ECBFF\">G\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">pct\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> start\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ${nextid}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">pct\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enter\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ${nextid}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Update system and install Tailscale\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> update\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> &#x26;&#x26; \u003C/span>\u003Cspan style=\"color:#B392F0\">apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> upgrade\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -y\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -y\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -fsSL\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> https://tailscale.com/install.sh\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> start\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> tailscaled\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">tailscale\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> up\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"usage-notes\">Usage Notes\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Run as root on Proxmox host\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">bash\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> proxmox-lxc-boot.sh\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"what-the-script-does\">What the script does:\u003C/h3>\n\u003Cul>\n\u003Cli>Finds the next available container ID automatically\u003C/li>\n\u003Cli>Creates Ubuntu 24.04 LXC container with specified resources\u003C/li>\n\u003Cli>Configures network with DHCP and custom nameservers\u003C/li>\n\u003Cli>Sets up storage with specified space allocation\u003C/li>\n\u003Cli>Installs and configures Tailscale VPN for secure remote access\u003C/li>\n\u003Cli>Container password is automatically set to container name\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"features\">Features:\u003C/h3>\n\u003Cul>\n\u003Cli>\u003Cstrong>Automatic ID generation\u003C/strong> - No manual container ID management\u003C/li>\n\u003Cli>\u003Cstrong>Ubuntu 24.04\u003C/strong> - Latest stable Ubuntu LTS\u003C/li>\n\u003Cli>\u003Cstrong>Tailscale integration\u003C/strong> - Secure mesh VPN out of the box\u003C/li>\n\u003Cli>\u003Cstrong>Resource optimization\u003C/strong> - Balanced memory, swap, and storage\u003C/li>\n\u003Cli>\u003Cstrong>Nesting enabled\u003C/strong> - Allows running Docker inside LXC\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"prerequisites\">Prerequisites:\u003C/h3>\n\u003Cul>\n\u003Cli>Proxmox VE installed and configured\u003C/li>\n\u003Cli>Network bridge (vmbr0) configured\u003C/li>\n\u003Cli>Storage (local-lvm) available\u003C/li>\n\u003Cli>Root access on Proxmox host\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"customization\">Customization:\u003C/h3>\n\u003Cul>\n\u003Cli>Modify \u003Ccode>memory\u003C/code>, \u003Ccode>swap\u003C/code>, and \u003Ccode>storage_space\u003C/code> variables as needed\u003C/li>\n\u003Cli>Change \u003Ccode>ctname\u003C/code> pattern for different naming conventions\u003C/li>\n\u003Cli>Adjust network bridge if using different network configuration\u003C/li>\n\u003C/ul>",{"headings":74,"localImagePaths":96,"remoteImagePaths":97,"frontmatter":98,"imagePaths":101},[75,78,81,84,87,90,93],{"depth":30,"slug":76,"text":77},"proxmox-lxc-initial-boot-script","Proxmox LXC Initial Boot Script",{"depth":32,"slug":79,"text":80},"script","Script",{"depth":32,"slug":82,"text":83},"usage-notes","Usage Notes",{"depth":36,"slug":85,"text":86},"what-the-script-does","What the script does:",{"depth":36,"slug":88,"text":89},"features","Features:",{"depth":36,"slug":91,"text":92},"prerequisites","Prerequisites:",{"depth":36,"slug":94,"text":95},"customization","Customization:",[],[],{"title":58,"description":59,"category":60,"tags":99,"created":100},[62,63,64,65,66],["Date","2024-11-10T00:00:00.000Z"],[],"proxmox-lxc-boot.md","rsync-backup",{"id":103,"data":105,"body":114,"filePath":115,"digest":116,"rendered":117,"legacyId":142},{"title":106,"description":107,"category":108,"tags":109,"created":113},"Using rsync for backup","Simple command to (safely) backup the home directory of a user","utility",[110,108,111,112],"linux","backup","rsync",["Date","2026-01-29T00:00:00.000Z"],"## Home Dir full backup\n\n```bash\nsudo rsync -a --info=progress2 --exclude=\"lost+found\" --exclude=\".cache\" \\\n    /home/ /mnt/usbdrive-name/\n```\n\n# General incremental file transfer\n\n## Local to Local:\n\n```bash\nrsync [OPTION]... [SRC]... DEST\n```\n\n## Local to Remote:\n\n```bash\nrsync [OPTION]... [SRC]... [USER@]HOST:DEST\n```\n\n## Remote to Local:\n\n```bash\nrsync [OPTION]... [USER@]HOST:SRC... [DEST]\n```","src/content/utilities/rsync-backup.md","89d4fa94463bd592",{"html":118,"metadata":119},"\u003Ch2 id=\"home-dir-full-backup\">Home Dir full backup\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rsync\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -a\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --info=progress2\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --exclude=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"lost+found\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --exclude=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\".cache\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    /home/\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /mnt/usbdrive-name/\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"general-incremental-file-transfer\">General incremental file transfer\u003C/h1>\n\u003Ch2 id=\"local-to-local\">Local to Local:\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">rsync\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [OPTION]... [SRC]... DEST\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"local-to-remote\">Local to Remote:\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">rsync\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [OPTION]... [SRC]... [USER@]HOST:DEST\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"remote-to-local\">Remote to Local:\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">rsync\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [OPTION]... [USER@]HOST:SRC... [DEST]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>",{"headings":120,"localImagePaths":136,"remoteImagePaths":137,"frontmatter":138,"imagePaths":141},[121,124,127,130,133],{"depth":32,"slug":122,"text":123},"home-dir-full-backup","Home Dir full backup",{"depth":30,"slug":125,"text":126},"general-incremental-file-transfer","General incremental file transfer",{"depth":32,"slug":128,"text":129},"local-to-local","Local to Local:",{"depth":32,"slug":131,"text":132},"local-to-remote","Local to Remote:",{"depth":32,"slug":134,"text":135},"remote-to-local","Remote to Local:",[],[],{"title":106,"description":107,"category":108,"tags":139,"created":140},[110,108,111,112],["Date","2026-01-29T00:00:00.000Z"],[],"rsync-backup.md","certificate-generation",{"id":143,"data":145,"body":156,"filePath":157,"digest":158,"rendered":159,"legacyId":205},{"title":146,"description":147,"category":148,"tags":149,"created":155},"Certificate Generation","SSL certificate generation using Certbot with DNS challenge validation","security",[150,151,152,153,154],"ssl","certbot","letsencrypt","docker","dns",["Date","2024-11-10T00:00:00.000Z"],"# SSL Certificate Generation\n\nGenerate SSL certificates using Certbot with DNS challenge validation. This method is ideal for automated certificate generation and wildcard certificates.\n\n## Docker Certbot Command\n\n```bash\ndocker run -it --rm --name certbot \\\n  -v \"./certs:/etc/letsencrypt\" \\\n  certbot/certbot certonly --manual \\\n  --preferred-challenges dns \\\n  -d DOMAIN\n```\n\n## Manual DNS Challenge Steps\n\n```bash\n# 1. Run the Docker command above\n# 2. Certbot will prompt you to create DNS TXT records\n# 3. Add the TXT records to your DNS provider\n# 4. Wait for DNS propagation (usually 1-5 minutes)\n# 5. Press Enter to continue validation\n# 6. Certificates will be saved in ./certs/\n```\n\n## Example Usage\n\n```bash\n# Generate certificate for example.com\ndocker run -it --rm --name certbot -v \"./certs:/etc/letsencrypt\" certbot/certbot certonly --manual --preferred-challenges dns -d example.com -d *.example.com\n\n# Generate wildcard certificate\ndocker run -it --rm --name certbot -v \"./certs:/etc/letsencrypt\" certbot/certbot certonly --manual --preferred-challenges dns -d \"*.example.com\"\n```\n\n## Certificate Locations\n\n```bash\n# Generated certificates will be in:\n./certs/live/DOMAIN/fullchain.pem\n./certs/live/DOMAIN/privkey.pem\n./certs/live/DOMAIN/cert.pem\n./certs/live/DOMAIN/chain.pem\n```\n\n## Automation Tips\n\n```bash\n# Use DNS provider APIs for automated validation\n# Set up cron jobs for automatic renewal\n# Use --dry-run to test without generating real certificates\n# Combine with Docker Compose for easier management\n```\n\n## DNS Provider Integration\n\n### Cloudflare\n```bash\n# Use Cloudflare API token with DNS challenge\ndocker run -it --rm --name certbot \\\n  -v \"./certs:/etc/letsencrypt\" \\\n  -e CLOUDFLARE_API_TOKEN=your_token \\\n  certbot/dns-cloudflare certonly \\\n  --dns-cloudflare \\\n  -d example.com -d *.example.com\n```\n\n### Route53\n```bash\n# Use AWS credentials for Route53\ndocker run -it --rm --name certbot \\\n  -v \"./certs:/etc/letsencrypt\" \\\n  -e AWS_ACCESS_KEY_ID=your_key \\\n  -e AWS_SECRET_ACCESS_KEY=your_secret \\\n  certbot/dns-route53 certonly \\\n  --dns-route53 \\\n  -d example.com\n```\n\n## Renewal Commands\n\n```bash\n# Test renewal (dry run)\ndocker run -it --rm --name certbot \\\n  -v \"./certs:/etc/letsencrypt\" \\\n  certbot/certbot renew --dry-run\n\n# Actual renewal\ndocker run -it --rm --name certbot \\\n  -v \"./certs:/etc/letsencrypt\" \\\n  certbot/certbot renew\n```\n\n## Certificate Types\n\n- **Single Domain**: Certificate for one specific domain\n- **Multiple Domains**: Certificate covering multiple domains\n- **Wildcard**: Certificate for all subdomains (*.example.com)\n- **SAN (Subject Alternative Name)**: Certificate with multiple domain names\n\n## Best Practices\n\n- Use wildcard certificates for subdomains\n- Set up automatic renewal (certificates expire every 90 days)\n- Test with --dry-run before production use\n- Store certificates securely with proper permissions\n- Use environment variables for sensitive data\n- Monitor certificate expiration dates","src/content/utilities/certificate-generation.md","999e36585fcc1f87",{"html":160,"metadata":161},"\u003Ch1 id=\"ssl-certificate-generation\">SSL Certificate Generation\u003C/h1>\n\u003Cp>Generate SSL certificates using Certbot with DNS challenge validation. This method is ideal for automated certificate generation and wildcard certificates.\u003C/p>\n\u003Ch2 id=\"docker-certbot-command\">Docker Certbot Command\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -it\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -v\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./certs:/etc/letsencrypt\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  certbot/certbot\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certonly\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --manual\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --preferred-challenges\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> dns\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> DOMAIN\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"manual-dns-challenge-steps\">Manual DNS Challenge Steps\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 1. Run the Docker command above\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 2. Certbot will prompt you to create DNS TXT records\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 3. Add the TXT records to your DNS provider\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 4. Wait for DNS propagation (usually 1-5 minutes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 5. Press Enter to continue validation\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 6. Certificates will be saved in ./certs/\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"example-usage\">Example Usage\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Generate certificate for example.com\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -it\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -v\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./certs:/etc/letsencrypt\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot/certbot\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certonly\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --manual\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --preferred-challenges\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> dns\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> example.com\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> *\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.example.com\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Generate wildcard certificate\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -it\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -v\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./certs:/etc/letsencrypt\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot/certbot\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certonly\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --manual\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --preferred-challenges\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> dns\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"*.example.com\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"certificate-locations\">Certificate Locations\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Generated certificates will be in:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./certs/live/DOMAIN/fullchain.pem\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./certs/live/DOMAIN/privkey.pem\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./certs/live/DOMAIN/cert.pem\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./certs/live/DOMAIN/chain.pem\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"automation-tips\">Automation Tips\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Use DNS provider APIs for automated validation\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Set up cron jobs for automatic renewal\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Use --dry-run to test without generating real certificates\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Combine with Docker Compose for easier management\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"dns-provider-integration\">DNS Provider Integration\u003C/h2>\n\u003Ch3 id=\"cloudflare\">Cloudflare\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Use Cloudflare API token with DNS challenge\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -it\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -v\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./certs:/etc/letsencrypt\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -e\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> CLOUDFLARE_API_TOKEN=your_token\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  certbot/dns-cloudflare\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certonly\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --dns-cloudflare\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> example.com\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> *\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.example.com\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"route53\">Route53\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Use AWS credentials for Route53\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -it\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -v\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./certs:/etc/letsencrypt\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -e\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> AWS_ACCESS_KEY_ID=your_key\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -e\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> AWS_SECRET_ACCESS_KEY=your_secret\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  certbot/dns-route53\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certonly\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  --dns-route53\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> example.com\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"renewal-commands\">Renewal Commands\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Test renewal (dry run)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -it\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -v\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./certs:/etc/letsencrypt\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  certbot/certbot\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> renew\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --dry-run\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Actual renewal\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -it\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> certbot\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  -v\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./certs:/etc/letsencrypt\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  certbot/certbot\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> renew\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"certificate-types\">Certificate Types\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Cstrong>Single Domain\u003C/strong>: Certificate for one specific domain\u003C/li>\n\u003Cli>\u003Cstrong>Multiple Domains\u003C/strong>: Certificate covering multiple domains\u003C/li>\n\u003Cli>\u003Cstrong>Wildcard\u003C/strong>: Certificate for all subdomains (*.example.com)\u003C/li>\n\u003Cli>\u003Cstrong>SAN (Subject Alternative Name)\u003C/strong>: Certificate with multiple domain names\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"best-practices\">Best Practices\u003C/h2>\n\u003Cul>\n\u003Cli>Use wildcard certificates for subdomains\u003C/li>\n\u003Cli>Set up automatic renewal (certificates expire every 90 days)\u003C/li>\n\u003Cli>Test with —dry-run before production use\u003C/li>\n\u003Cli>Store certificates securely with proper permissions\u003C/li>\n\u003Cli>Use environment variables for sensitive data\u003C/li>\n\u003Cli>Monitor certificate expiration dates\u003C/li>\n\u003C/ul>",{"headings":162,"localImagePaths":199,"remoteImagePaths":200,"frontmatter":201,"imagePaths":204},[163,166,169,172,175,178,181,184,187,190,193,196],{"depth":30,"slug":164,"text":165},"ssl-certificate-generation","SSL Certificate Generation",{"depth":32,"slug":167,"text":168},"docker-certbot-command","Docker Certbot Command",{"depth":32,"slug":170,"text":171},"manual-dns-challenge-steps","Manual DNS Challenge Steps",{"depth":32,"slug":173,"text":174},"example-usage","Example Usage",{"depth":32,"slug":176,"text":177},"certificate-locations","Certificate Locations",{"depth":32,"slug":179,"text":180},"automation-tips","Automation Tips",{"depth":32,"slug":182,"text":183},"dns-provider-integration","DNS Provider Integration",{"depth":36,"slug":185,"text":186},"cloudflare","Cloudflare",{"depth":36,"slug":188,"text":189},"route53","Route53",{"depth":32,"slug":191,"text":192},"renewal-commands","Renewal Commands",{"depth":32,"slug":194,"text":195},"certificate-types","Certificate Types",{"depth":32,"slug":197,"text":198},"best-practices","Best Practices",[],[],{"title":146,"description":147,"category":148,"tags":202,"created":203},[150,151,152,153,154],["Date","2024-11-10T00:00:00.000Z"],[],"certificate-generation.md","docker-install",{"id":206,"data":208,"body":215,"filePath":216,"digest":217,"rendered":218,"legacyId":262},{"title":209,"description":210,"category":153,"tags":211,"created":214},"Docker Installation","Complete Docker installation script for Ubuntu systems from official repositories",[153,212,65,213],"installation","containers",["Date","2024-11-10T00:00:00.000Z"],"# Docker Installation Script\n\nComplete Docker installation script for Ubuntu systems. This script installs the latest Docker Engine from Docker's official repositories.\n\n## Installation Script\n\n```bash\n#!/bin/bash\n\n# Remove old Docker versions\nfor pkg in docker.io docker-doc docker-compose docker-compose-v2 podman-docker containerd runc; do\n  sudo apt-get remove $pkg\ndone\n\n# Add Docker's official GPG key:\nsudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n\n# Add the repository to Apt sources:\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release && echo \"${UBUNTU_CODENAME:-$VERSION_CODENAME}\") stable\" | \\\n  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\n\n# Install Docker Engine\nsudo apt-get update\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n```\n\n## Post-Installation Steps\n\n```bash\n# Add your user to the docker group\nsudo usermod -aG docker $USER\n\n# Activate group changes (log out and back in, or run:)\nnewgrp docker\n\n# Verify installation\ndocker --version\ndocker compose version\n\n# Test Docker\ndocker run hello-world\n```\n\n## Usage Notes\n\n```bash\n# Save the script as install-docker.sh\nchmod +x install-docker.sh\n./install-docker.sh\n\n# Or run directly:\ncurl -fsSL https://get.docker.com | sh\n\n# Warning: The script removes existing Docker installations\n# Make sure to backup any important containers/data\n```\n\n## Alternative: One-Line Install\n\n```bash\n# Use Docker's official install script:\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n\n# Or direct pipe:\ncurl -fsSL https://get.docker.com | sh\n```\n\n## Uninstall Docker\n\n```bash\n# Remove Docker packages\nsudo apt-get purge docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# Remove images, containers, and volumes\nsudo rm -rf /var/lib/docker\nsudo rm -rf /var/lib/containerd\n```\n\n## Docker Compose Setup\n\n```bash\n# Install Docker Compose (if not included)\nsudo apt-get install docker-compose-plugin\n\n# Verify Docker Compose\ndocker compose version\n\n# Create docker-compose.yml file\ncat > docker-compose.yml \u003C\u003C 'EOF'\nversion: '3.8'\nservices:\n  web:\n    image: nginx:alpine\n    ports:\n      - \"80:80\"\nEOF\n\n# Run with Docker Compose\ndocker compose up -d\n```\n\n## Common Issues\n\n### Permission Denied\n```bash\n# If you get \"Got permission denied\" error:\nsudo usermod -aG docker $USER\nnewgrp docker\n```\n\n### Port Already in Use\n```bash\n# Check what's using the port\nsudo netstat -tulpn | grep :80\n\n# Or use lsof\nsudo lsof -i :80\n```\n\n### Docker Daemon Not Running\n```bash\n# Start Docker service\nsudo systemctl start docker\nsudo systemctl enable docker\n\n# Check status\nsudo systemctl status docker\n```\n\n## Production Considerations\n\n- Use specific Docker versions in production\n- Set up logging and monitoring\n- Configure resource limits\n- Implement security best practices\n- Use Docker in rootless mode when possible\n- Set up automated updates and backups","src/content/utilities/docker-install.md","a5d9383e1d1890ee",{"html":219,"metadata":220},"\u003Ch1 id=\"docker-installation-script\">Docker Installation Script\u003C/h1>\n\u003Cp>Complete Docker installation script for Ubuntu systems. This script installs the latest Docker Engine from Docker’s official repositories.\u003C/p>\n\u003Ch2 id=\"installation-script\">Installation Script\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#!/bin/bash\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Remove old Docker versions\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pkg \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker.io\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-doc\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-compose\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-compose-v2\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> podman-docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> containerd\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> runc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#F97583\">do\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $pkg\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">done\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Add Docker's official GPG key:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> update\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ca-certificates\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> curl\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -m\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0755\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/keyrings\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -fsSL\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> https://download.docker.com/linux/ubuntu/gpg\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -o\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/keyrings/docker.asc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> chmod\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> a+r\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/keyrings/docker.asc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Add the repository to Apt sources:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">echo\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  \"deb [arch=$(\u003C/span>\u003Cspan style=\"color:#B392F0\">dpkg\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --print-architecture\u003C/span>\u003Cspan style=\"color:#9ECBFF\">) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  $(\u003C/span>\u003Cspan style=\"color:#79B8FF\">.\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/os-release &#x26;&#x26; \u003C/span>\u003Cspan style=\"color:#79B8FF\">echo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">UBUNTU_CODENAME\u003C/span>\u003Cspan style=\"color:#F97583\">:-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">$VERSION_CODENAME\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\") stable\"\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> tee\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/sources.list.d/docker.list\u003C/span>\u003Cspan style=\"color:#F97583\"> >\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /dev/null\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Install Docker Engine\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> update\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-ce\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-ce-cli\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> containerd.io\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-buildx-plugin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-compose-plugin\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"post-installation-steps\">Post-Installation Steps\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Add your user to the docker group\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> usermod\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -aG\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $USER\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Activate group changes (log out and back in, or run:)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">newgrp\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Verify installation\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --version\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> compose\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> version\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Test Docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> hello-world\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"usage-notes\">Usage Notes\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Save the script as install-docker.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">chmod\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> +x\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install-docker.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./install-docker.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Or run directly:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -fsSL\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> https://get.docker.com\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Warning: The script removes existing Docker installations\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Make sure to backup any important containers/data\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"alternative-one-line-install\">Alternative: One-Line Install\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Use Docker's official install script:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -fsSL\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> https://get.docker.com\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -o\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> get-docker.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> sh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> get-docker.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Or direct pipe:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -fsSL\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> https://get.docker.com\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> sh\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"uninstall-docker\">Uninstall Docker\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Remove Docker packages\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> purge\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-ce\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-ce-cli\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> containerd.io\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-buildx-plugin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-compose-plugin\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Remove images, containers, and volumes\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -rf\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /var/lib/docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rm\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -rf\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /var/lib/containerd\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"docker-compose-setup\">Docker Compose Setup\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Install Docker Compose (if not included)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-compose-plugin\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Verify Docker Compose\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> compose\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> version\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Create docker-compose.yml file\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cat\u003C/span>\u003Cspan style=\"color:#F97583\"> >\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-compose.yml\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x3C;&#x3C;\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'EOF'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">version: '3.8'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">services:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  web:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    image: nginx:alpine\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    ports:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">      - \"80:80\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">EOF\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Run with Docker Compose\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> compose\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> up\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"common-issues\">Common Issues\u003C/h2>\n\u003Ch3 id=\"permission-denied\">Permission Denied\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># If you get \"Got permission denied\" error:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> usermod\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -aG\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $USER\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">newgrp\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"port-already-in-use\">Port Already in Use\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Check what's using the port\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> netstat\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -tulpn\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> :80\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Or use lsof\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> lsof\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -i\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> :80\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"docker-daemon-not-running\">Docker Daemon Not Running\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Start Docker service\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> systemctl\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> start\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> systemctl\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enable\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Check status\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> systemctl\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> status\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"production-considerations\">Production Considerations\u003C/h2>\n\u003Cul>\n\u003Cli>Use specific Docker versions in production\u003C/li>\n\u003Cli>Set up logging and monitoring\u003C/li>\n\u003Cli>Configure resource limits\u003C/li>\n\u003Cli>Implement security best practices\u003C/li>\n\u003Cli>Use Docker in rootless mode when possible\u003C/li>\n\u003Cli>Set up automated updates and backups\u003C/li>\n\u003C/ul>",{"headings":221,"localImagePaths":256,"remoteImagePaths":257,"frontmatter":258,"imagePaths":261},[222,225,228,231,232,235,238,241,244,247,250,253],{"depth":30,"slug":223,"text":224},"docker-installation-script","Docker Installation Script",{"depth":32,"slug":226,"text":227},"installation-script","Installation Script",{"depth":32,"slug":229,"text":230},"post-installation-steps","Post-Installation Steps",{"depth":32,"slug":82,"text":83},{"depth":32,"slug":233,"text":234},"alternative-one-line-install","Alternative: One-Line Install",{"depth":32,"slug":236,"text":237},"uninstall-docker","Uninstall Docker",{"depth":32,"slug":239,"text":240},"docker-compose-setup","Docker Compose Setup",{"depth":32,"slug":242,"text":243},"common-issues","Common Issues",{"depth":36,"slug":245,"text":246},"permission-denied","Permission Denied",{"depth":36,"slug":248,"text":249},"port-already-in-use","Port Already in Use",{"depth":36,"slug":251,"text":252},"docker-daemon-not-running","Docker Daemon Not Running",{"depth":32,"slug":254,"text":255},"production-considerations","Production Considerations",[],[],{"title":209,"description":210,"category":153,"tags":259,"created":260},[153,212,65,213],["Date","2024-11-10T00:00:00.000Z"],[],"docker-install.md","rootless-docker",{"id":263,"data":265,"body":272,"filePath":273,"digest":274,"rendered":275,"legacyId":325},{"title":266,"description":267,"category":153,"tags":268,"created":271},"Rootless Docker Setup","Secure rootless Docker daemon setup for running containers without root privileges",[153,148,269,213,270],"rootless","systemd",["Date","2024-11-10T00:00:00.000Z"],"# Rootless Docker Setup\n\nRootless Docker allows running Docker daemon and containers as a non-root user, improving security by reducing the attack surface and container breakout risks.\n\n## Installation Script\n\n```bash\n#!/bin/bash\n\n# Install prerequisites\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n\n# Add the repository to Apt sources:\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release && echo \"${UBUNTU_CODENAME:-$VERSION_CODENAME}\") stable\" | \\\n  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\n\n# Install Docker packages\nsudo apt-get update\nsudo apt install uidmap docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# Disable root Docker service\nsudo systemctl disable --now docker.service docker.socket\nsudo rm /var/run/docker.sock\n\n# Create dedicated user for rootless Docker\nsudo groupadd --system docker\nsudo useradd -m --system -g docker $TARGET_USER\n\n# Set up rootless Docker\nPATH=/usr/bin:$PATH\n/usr/bin/dockerd-rootless-setuptool.sh install\n```\n\n## Setup Instructions\n\n```bash\n# 1. Replace $TARGET_USER with your desired username\n# 2. Run the installation script\nchmod +x rootless-docker-setup.sh\n./rootless-docker-setup.sh\n\n# 3. Add environment variables to your shell profile\necho 'export PATH=/usr/bin:$PATH' >> ~/.bashrc\necho 'export DOCKER_HOST=unix:///run/user/$(id -u)/docker.sock' >> ~/.bashrc\nsource ~/.bashrc\n\n# 4. Start the rootless Docker service\nsystemctl --user start docker\nsystemctl --user enable docker\n\n# 5. Verify installation\ndocker --version\ndocker run hello-world\n```\n\n## Service Management\n\n```bash\n# Start rootless Docker service\nsystemctl --user start docker\n\n# Stop rootless Docker service\nsystemctl --user stop docker\n\n# Check service status\nsystemctl --user status docker\n\n# Enable auto-start on boot\nsystemctl --user enable docker\nloginctl enable-linger $USER\n```\n\n## Limitations & Considerations\n\n### Port Binding Limitations\n- Can only bind to ports >= 1024\n- Use port forwarding for privileged ports\n\n### Network Limitations\n- Some network drivers may not work\n- Host networking is restricted\n\n### Storage Limitations\n- Some storage drivers may not be available\n- FUSE overlayfs is used by default\n\n### Performance\n- Slightly reduced performance due to user namespace\n- Additional overhead for system calls\n\n## Troubleshooting\n\n```bash\n# Check if rootless mode is active\ndocker info | grep -i rootless\n\n# Check user namespace support\ncat /proc/sys/kernel/unprivileged_userns_clone\n\n# Enable user namespaces if disabled\necho 'kernel.unprivileged_userns_clone=1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n\n# Fix permission issues\nsudo setcap cap_net_bind_service=ep $(which rootlesskit)\n```\n\n## Security Benefits\n\n- **Reduced attack surface** - No root privileges required\n- **User namespace isolation** - Enhanced container security\n- **Container breakout protection** - Limits damage from container escapes\n- **Better multi-user security** - Each user has isolated Docker instances\n- **Compliance with security policies** - Meets strict security requirements\n\n## Port Forwarding for Privileged Ports\n\n```bash\n# Forward port 80 to 8080 for web applications\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080\n\n# Or use socat for simple forwarding\nsocat TCP-LISTEN:80,fork TCP:localhost:8080\n```\n\n## Systemd User Service\n\nCreate `~/.config/systemd/user/docker.service`:\n\n```ini\n[Unit]\nDescription=Docker Application Container Engine (Rootless)\nDocumentation=https://docs.docker.com\n\n[Service]\nType=notify\nExecStart=/usr/bin/dockerd-rootless.sh\nExecReload=/bin/kill -s HUP $MAINPID\nTimeoutSec=0\nRestartSec=2\nRestart=always\nStartLimitBurst=3\nStartLimitInterval=60s\nLimitNOFILE=infinity\nLimitNPROC=infinity\nLimitCORE=infinity\nTasksMax=infinity\nDelegate=yes\n\n[Install]\nWantedBy=default.target\n```\n\n## Best Practices\n\n- Use rootless mode for development and testing\n- Consider rootless for production with proper security review\n- Monitor resource usage as rootless has higher overhead\n- Use volume mounts instead of bind mounts when possible\n- Keep the system updated with security patches\n\n## Migration from Root Docker\n\n```bash\n# Stop root Docker\nsudo systemctl stop docker\n\n# Export containers and images\ndocker save -o containers.tar $(docker images -q)\n\n# Start rootless Docker\nsystemctl --user start docker\n\n# Import containers and images\ndocker load -i containers.tar\n```","src/content/utilities/rootless-docker.md","0de3af73fc126fef",{"html":276,"metadata":277},"\u003Ch1 id=\"rootless-docker-setup\">Rootless Docker Setup\u003C/h1>\n\u003Cp>Rootless Docker allows running Docker daemon and containers as a non-root user, improving security by reducing the attack surface and container breakout risks.\u003C/p>\n\u003Ch2 id=\"installation-script\">Installation Script\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#!/bin/bash\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Install prerequisites\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ca-certificates\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> curl\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -m\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0755\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/keyrings\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -fsSL\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> https://download.docker.com/linux/ubuntu/gpg\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -o\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/keyrings/docker.asc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> chmod\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> a+r\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/keyrings/docker.asc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Add the repository to Apt sources:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">echo\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  \"deb [arch=$(\u003C/span>\u003Cspan style=\"color:#B392F0\">dpkg\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --print-architecture\u003C/span>\u003Cspan style=\"color:#9ECBFF\">) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  $(\u003C/span>\u003Cspan style=\"color:#79B8FF\">.\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/os-release &#x26;&#x26; \u003C/span>\u003Cspan style=\"color:#79B8FF\">echo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"${\u003C/span>\u003Cspan style=\"color:#E1E4E8\">UBUNTU_CODENAME\u003C/span>\u003Cspan style=\"color:#F97583\">:-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">$VERSION_CODENAME\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\") stable\"\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> tee\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/apt/sources.list.d/docker.list\u003C/span>\u003Cspan style=\"color:#F97583\"> >\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /dev/null\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Install Docker packages\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt-get\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> update\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apt\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> uidmap\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-ce\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-ce-cli\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> containerd.io\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-buildx-plugin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker-compose-plugin\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Disable root Docker service\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> systemctl\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> disable\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --now\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker.service\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker.socket\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rm\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /var/run/docker.sock\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Create dedicated user for rootless Docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> groupadd\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --system\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> useradd\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -m\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --system\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -g\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $TARGET_USER\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Set up rootless Docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">PATH\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">/usr/bin:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">$PATH\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">/usr/bin/dockerd-rootless-setuptool.sh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> install\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"setup-instructions\">Setup Instructions\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 1. Replace $TARGET_USER with your desired username\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 2. Run the installation script\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">chmod\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> +x\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rootless-docker-setup.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./rootless-docker-setup.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 3. Add environment variables to your shell profile\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">echo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'export PATH=/usr/bin:$PATH'\u003C/span>\u003Cspan style=\"color:#F97583\"> >>\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ~/.bashrc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">echo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'export DOCKER_HOST=unix:///run/user/$(id -u)/docker.sock'\u003C/span>\u003Cspan style=\"color:#F97583\"> >>\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ~/.bashrc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">source\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ~/.bashrc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 4. Start the rootless Docker service\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --user\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> start\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --user\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enable\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 5. Verify installation\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --version\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> hello-world\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"service-management\">Service Management\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Start rootless Docker service\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --user\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> start\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Stop rootless Docker service\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --user\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> stop\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Check service status\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --user\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> status\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Enable auto-start on boot\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --user\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enable\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">loginctl\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enable-linger\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $USER\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"limitations--considerations\">Limitations &#x26; Considerations\u003C/h2>\n\u003Ch3 id=\"port-binding-limitations\">Port Binding Limitations\u003C/h3>\n\u003Cul>\n\u003Cli>Can only bind to ports >= 1024\u003C/li>\n\u003Cli>Use port forwarding for privileged ports\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"network-limitations\">Network Limitations\u003C/h3>\n\u003Cul>\n\u003Cli>Some network drivers may not work\u003C/li>\n\u003Cli>Host networking is restricted\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"storage-limitations\">Storage Limitations\u003C/h3>\n\u003Cul>\n\u003Cli>Some storage drivers may not be available\u003C/li>\n\u003Cli>FUSE overlayfs is used by default\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"performance\">Performance\u003C/h3>\n\u003Cul>\n\u003Cli>Slightly reduced performance due to user namespace\u003C/li>\n\u003Cli>Additional overhead for system calls\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"troubleshooting\">Troubleshooting\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Check if rootless mode is active\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> info\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -i\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rootless\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Check user namespace support\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cat\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /proc/sys/kernel/unprivileged_userns_clone\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Enable user namespaces if disabled\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">echo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'kernel.unprivileged_userns_clone=1'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> tee\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -a\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /etc/sysctl.conf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> sysctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Fix permission issues\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> setcap\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> cap_net_bind_service=ep\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $(\u003C/span>\u003Cspan style=\"color:#79B8FF\">which\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rootlesskit\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"security-benefits\">Security Benefits\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Cstrong>Reduced attack surface\u003C/strong> - No root privileges required\u003C/li>\n\u003Cli>\u003Cstrong>User namespace isolation\u003C/strong> - Enhanced container security\u003C/li>\n\u003Cli>\u003Cstrong>Container breakout protection\u003C/strong> - Limits damage from container escapes\u003C/li>\n\u003Cli>\u003Cstrong>Better multi-user security\u003C/strong> - Each user has isolated Docker instances\u003C/li>\n\u003Cli>\u003Cstrong>Compliance with security policies\u003C/strong> - Meets strict security requirements\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"port-forwarding-for-privileged-ports\">Port Forwarding for Privileged Ports\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Forward port 80 to 8080 for web applications\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> iptables\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -t\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> nat\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -A\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> PREROUTING\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> tcp\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --dport\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 80\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -j\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> REDIRECT\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --to-port\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 8080\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Or use socat for simple forwarding\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">socat\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> TCP-LISTEN:80,fork\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> TCP:localhost:8080\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"systemd-user-service\">Systemd User Service\u003C/h2>\n\u003Cp>Create \u003Ccode>~/.config/systemd/user/docker.service\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"ini\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">[Unit]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">Description\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=Docker Application Container Engine (Rootless)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">Documentation\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=https://docs.docker.com\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">[Service]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">Type\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=notify\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">ExecStart\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=/usr/bin/dockerd-rootless.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">ExecReload\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=/bin/kill -s HUP $MAINPID\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">TimeoutSec\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">RestartSec\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">Restart\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=always\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">StartLimitBurst\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">StartLimitInterval\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=60s\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">LimitNOFILE\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=infinity\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">LimitNPROC\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=infinity\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">LimitCORE\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=infinity\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">TasksMax\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=infinity\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">Delegate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=yes\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">[Install]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">WantedBy\u003C/span>\u003Cspan style=\"color:#E1E4E8\">=default.target\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"best-practices\">Best Practices\u003C/h2>\n\u003Cul>\n\u003Cli>Use rootless mode for development and testing\u003C/li>\n\u003Cli>Consider rootless for production with proper security review\u003C/li>\n\u003Cli>Monitor resource usage as rootless has higher overhead\u003C/li>\n\u003Cli>Use volume mounts instead of bind mounts when possible\u003C/li>\n\u003Cli>Keep the system updated with security patches\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"migration-from-root-docker\">Migration from Root Docker\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Stop root Docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">sudo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> systemctl\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> stop\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Export containers and images\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> save\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -o\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> containers.tar\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $(\u003C/span>\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> images\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -q\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Start rootless Docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">systemctl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --user\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> start\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> docker\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Import containers and images\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">docker\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> load\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -i\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> containers.tar\u003C/span>\u003C/span>\u003C/code>\u003C/pre>",{"headings":278,"localImagePaths":319,"remoteImagePaths":320,"frontmatter":321,"imagePaths":324},[279,281,282,285,288,291,294,297,300,303,306,309,312,315,316],{"depth":30,"slug":280,"text":266},"rootless-docker-setup",{"depth":32,"slug":226,"text":227},{"depth":32,"slug":283,"text":284},"setup-instructions","Setup Instructions",{"depth":32,"slug":286,"text":287},"service-management","Service Management",{"depth":32,"slug":289,"text":290},"limitations--considerations","Limitations & Considerations",{"depth":36,"slug":292,"text":293},"port-binding-limitations","Port Binding Limitations",{"depth":36,"slug":295,"text":296},"network-limitations","Network Limitations",{"depth":36,"slug":298,"text":299},"storage-limitations","Storage Limitations",{"depth":36,"slug":301,"text":302},"performance","Performance",{"depth":32,"slug":304,"text":305},"troubleshooting","Troubleshooting",{"depth":32,"slug":307,"text":308},"security-benefits","Security Benefits",{"depth":32,"slug":310,"text":311},"port-forwarding-for-privileged-ports","Port Forwarding for Privileged Ports",{"depth":32,"slug":313,"text":314},"systemd-user-service","Systemd User Service",{"depth":32,"slug":197,"text":198},{"depth":32,"slug":317,"text":318},"migration-from-root-docker","Migration from Root Docker",[],[],{"title":266,"description":267,"category":153,"tags":322,"created":323},[153,148,269,213,270],["Date","2024-11-10T00:00:00.000Z"],[],"rootless-docker.md","sops-nix-configuration",{"id":326,"data":328,"body":337,"filePath":338,"digest":339,"rendered":340,"legacyId":357},{"title":329,"description":330,"category":331,"tags":332,"created":336},"sops-nix Configuration","Configure sops-nix to save and distribute secrets securely in NixOS","nix",[331,148,333,334,335],"secrets","secret management","declarative",["Date","2026-01-28T00:00:00.000Z"],"# sops-nix Configuration\n\nModify the existing `flake.nix` as such:\n\n```nix\n{\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/nixos-unstable\";\n    nixd.url = \"github:nix-community/nixd/main\";\n    nixfmt.url = \"github:NixOS/nixfmt/master\";\n    home-manager = {\n      url = \"github:nix-community/home-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    ...\n    sops-nix = {\n      url = \"github:Mic92/sops-nix\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs =\n    inputs@{\n      self,\n      nixpkgs,\n      home-manager,\n      sops-nix,\n      ...\n    }:\n    ...\n    {\n      nixosConfigurations.\"nixos\" = nixpkgs.lib.nixosSystem {\n        ...\n      };\n      ...\n      sops-nix.nixosModules.sops\n```\n\nThen, generate age key pair (recommended over GPG)\n\n```bash\nnix-shell -p age --run \"age-keygen -o ~/.config/sops/age/keys.txt\"\ncat ~/.config/sops/age/keys.txt | grep \"public key:\" | cut -d: -f2 | xargs\n```\n\nThe second command should print the generated public key, which we will store in `/etc/nixos/.sops.yaml`:\n\n```nix\ncreation_rules:\n  - path_regex: secrets/.*\\.yaml$\n    key_groups:\n      - age:\n          - \"PUBLIC_KEY\"\n```\n\nNext, we create the unencrypted file in `/etc/nixos/secrets.yaml`:\n\n```yaml\nKEY_1: VALUE\nKEY_2: ANOTHER_VALUE\n....\n```\n\nWhich we encrypt with:\n\n`nix-shell -p sops --run \"sops --config /etc/nixos/secrets.yaml --encrypt --in-place /etc/nixos/secrets/secrets-enc.yaml\"`\n\n***IMPORTANT NOTE:*** NEVER forget to keep a `.gitignore` here, and to update it with the name of the `secrets.yaml` file, since it will contain all the unencrypted secrets.\n\nAfter this, we create the file `/etc/nixos/sops.nix`:\n\n```nix\n{\n  sops = {\n    defaultSopsFile = ./secrets/secrets.yaml;\n    age.keyFile = \"/home/hytx/.config/sops/age/keys.txt\";\n    secrets = {\n      deepseekAPIKey = {\n        mode = \"0400\";\n        owner = \"root\";\n        group = \"root\";\n        path = \"/run/secrets/deepseek-api-key\";\n      };\n      xSTFCTFDToken = {\n        mode = \"0400\";\n        owner = \"root\";\n        group = \"root\";\n        path = \"/run/secrets/ctfd-token\";\n      };\n      xSTFCTFDURL = {\n        mode = \"0400\";\n        owner = \"root\";\n        group = \"root\";\n        path = \"/run/secrets/ctfd-url\";\n      };\n      xSTFCTFDDeployHost = {\n        mode = \"0400\";\n        owner = \"root\";\n        group = \"root\";\n        path = \"/run/secrets/ctfd-deploy-host\";\n      };\n      INESCTECVPNConfig = {\n        mode = \"0400\";\n        owner = \"root\";\n        group = \"root\";\n        path = \"/etc/openvpn/inesctec.conf\";\n        sopsFile = ./secrets/secrets.yaml;\n      };\n    };\n  };\n}\n```\n\nAnd import it in `configuration.nix`:\n\n```nix\n{ ... }:\n{\n  imports = [\n    ./hardware-configuration.nix\n    ...\n    ./sops.nix\n  ];\n```\n\nThe secrets will be created in `/run/secrets/KEY_NAME`, with this configuration, being read-only only by root.\n\n## Secret usage in Nix configuration files\n\nSince the secrets are stored in `/run`, we need to access them out-of-band, outside of the evaluation time when rebuilding the system.\n\nThe way we do this is, instead of realizing the actual path on rebuild, we set environment variables to read from the key paths:\n\n```nix\n{ ... }:\n{\n  environment = {\n    ...\n    shellInit = ''\n      ...\n      if [ -f /run/secrets/KEY_1 ]; then\n        export KEY_1=\"$(cat /run/secrets/KEY_1)\"\n      fi\n      if [ -f /run/secrets/KEY_2 ]; then\n        export KEY_2=\"$(cat /run/secrets/KEY_2)\"\n      fi\n      ...\n    '';\n    ...\n```\n\n## Updating secrets\n\nSimply use `nix-shell -p sops --run \"sops /etc/nixos/secrets/secrets.yaml\"` to live edit the secrets, do not forget to include/exclude them from the `sops.nix` file, or the rebuild will fail.","src/content/utilities/sops-nix-configuration.md","291c4fe98f97c826",{"html":341,"metadata":342},"\u003Ch1 id=\"sops-nix-configuration\">sops-nix Configuration\u003C/h1>\n\u003Cp>Modify the existing \u003Ccode>flake.nix\u003C/code> as such:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"nix\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  inputs\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    nixpkgs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">url\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"github:NixOS/nixpkgs/nixos-unstable\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    nixd\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">url\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"github:nix-community/nixd/main\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    nixfmt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">url\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"github:NixOS/nixfmt/master\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    home-manager\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      url\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"github:nix-community/home-manager\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      inputs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">nixpkgs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">follows\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"nixpkgs\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    sops-nix\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      url\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"github:Mic92/sops-nix\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      inputs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">nixpkgs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">follows\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"nixpkgs\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  outputs\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    inputs@{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      self\u003C/span>\u003Cspan style=\"color:#F97583\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      nixpkgs\u003C/span>\u003Cspan style=\"color:#F97583\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      home-manager\u003C/span>\u003Cspan style=\"color:#F97583\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      sops-nix\u003C/span>\u003Cspan style=\"color:#F97583\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      nixosConfigurations\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"nixos\"\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#FFAB70\"> nixpkgs\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">lib\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">nixosSystem\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      sops-nix.nixosModules.sops\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Then, generate age key pair (recommended over GPG)\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">nix-shell\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> age\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --run\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"age-keygen -o ~/.config/sops/age/keys.txt\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cat\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ~/.config/sops/age/keys.txt\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"public key:\"\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> cut\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -f2\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> xargs\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The second command should print the generated public key, which we will store in \u003Ccode>/etc/nixos/.sops.yaml\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"nix\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">creation_rules:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  -\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> path_regex: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">secrets/.\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">\\\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">yaml\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">$\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    key_groups:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      -\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> age:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">          -\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"PUBLIC_KEY\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Next, we create the unencrypted file in \u003Ccode>/etc/nixos/secrets.yaml\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"yaml\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#85E89D\">KEY_1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">VALUE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#85E89D\">KEY_2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">ANOTHER_VALUE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">...\u003C/span>\u003Cspan style=\"color:#79B8FF\">.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Which we encrypt with:\u003C/p>\n\u003Cp>\u003Ccode>nix-shell -p sops --run \"sops --config /etc/nixos/secrets.yaml --encrypt --in-place /etc/nixos/secrets/secrets-enc.yaml\"\u003C/code>\u003C/p>\n\u003Cp>\u003Cem>\u003Cstrong>IMPORTANT NOTE:\u003C/strong>\u003C/em> NEVER forget to keep a \u003Ccode>.gitignore\u003C/code> here, and to update it with the name of the \u003Ccode>secrets.yaml\u003C/code> file, since it will contain all the unencrypted secrets.\u003C/p>\n\u003Cp>After this, we create the file \u003Ccode>/etc/nixos/sops.nix\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"nix\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  sops\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    defaultSopsFile\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ./secrets/secrets.yaml\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    age\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">keyFile\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"/home/hytx/.config/sops/age/keys.txt\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    secrets\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      deepseekAPIKey\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        mode\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"0400\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        owner\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        group\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        path\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"/run/secrets/deepseek-api-key\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      xSTFCTFDToken\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        mode\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"0400\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        owner\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        group\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        path\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"/run/secrets/ctfd-token\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      xSTFCTFDURL\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        mode\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"0400\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        owner\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        group\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        path\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"/run/secrets/ctfd-url\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      xSTFCTFDDeployHost\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        mode\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"0400\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        owner\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        group\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        path\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"/run/secrets/ctfd-deploy-host\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      INESCTECVPNConfig\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        mode\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"0400\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        owner\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        group\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"root\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        path\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"/etc/openvpn/inesctec.conf\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        sopsFile\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ./secrets/secrets.yaml\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>And import it in \u003Ccode>configuration.nix\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"nix\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{ \u003C/span>\u003Cspan style=\"color:#F97583\">... \u003C/span>\u003Cspan style=\"color:#E1E4E8\">}:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  imports\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    ./hardware-configuration.nix\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    ./sops.nix\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ];\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The secrets will be created in \u003Ccode>/run/secrets/KEY_NAME\u003C/code>, with this configuration, being read-only only by root.\u003C/p>\n\u003Ch2 id=\"secret-usage-in-nix-configuration-files\">Secret usage in Nix configuration files\u003C/h2>\n\u003Cp>Since the secrets are stored in \u003Ccode>/run\u003C/code>, we need to access them out-of-band, outside of the evaluation time when rebuilding the system.\u003C/p>\n\u003Cp>The way we do this is, instead of realizing the actual path on rebuild, we set environment variables to read from the key paths:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"nix\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{ \u003C/span>\u003Cspan style=\"color:#F97583\">... \u003C/span>\u003Cspan style=\"color:#E1E4E8\">}:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  environment\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">    shellInit\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> =\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> ''\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      if\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> [\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> -f\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> /run/secrets/KEY_1\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> ];\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> then\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">        export\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> KEY_1=\"$(cat\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> /run/secrets/KEY_1)\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      fi\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      if\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> [\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> -f\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> /run/secrets/KEY_2\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> ];\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> then\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">        export\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> KEY_2=\"$(cat\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\"> /run/secrets/KEY_2)\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      fi\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">      ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">    '';\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FDAEB7;font-style:italic\">    ...\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"updating-secrets\">Updating secrets\u003C/h2>\n\u003Cp>Simply use \u003Ccode>nix-shell -p sops --run \"sops /etc/nixos/secrets/secrets.yaml\"\u003C/code> to live edit the secrets, do not forget to include/exclude them from the \u003Ccode>sops.nix\u003C/code> file, or the rebuild will fail.\u003C/p>",{"headings":343,"localImagePaths":351,"remoteImagePaths":352,"frontmatter":353,"imagePaths":356},[344,345,348],{"depth":30,"slug":326,"text":329},{"depth":32,"slug":346,"text":347},"secret-usage-in-nix-configuration-files","Secret usage in Nix configuration files",{"depth":32,"slug":349,"text":350},"updating-secrets","Updating secrets",[],[],{"title":329,"description":330,"category":331,"tags":354,"created":355},[331,148,333,334,335],["Date","2026-01-28T00:00:00.000Z"],[],"sops-nix-configuration.md"]