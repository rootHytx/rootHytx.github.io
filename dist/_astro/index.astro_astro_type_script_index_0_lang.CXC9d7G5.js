document.addEventListener("DOMContentLoaded",function(){let p=!0;const d=document.getElementById("terminal-output"),y=document.getElementById("terminal-input");document.querySelector(".directory-listing"),document.querySelector(".directory-path"),document.querySelector(".footer");let f=window.fileSystem||{"github-projects":{bloccChainz:{type:"project",url:"https://github.com/rootHytx/bloccChainz"},github:{type:"project",url:"https://github.com/rootHytx"},"sistemas-embutidos":{type:"project",url:"https://github.com/rootHytx/sistemas-embutidos"},"trabalho-redes":{type:"project",url:"https://github.com/rootHytx/trabalho-redes"}},utilities:{}};if(typeof f=="string")try{f=JSON.parse(f)}catch(t){console.error("Failed to parse fileSystem:",t)}if(f.utilities&&Object.keys(f.utilities).length===0&&window.utilitiesData)try{let t=window.utilitiesData;typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)&&t.forEach(e=>{e&&e.id&&(f.utilities[e.id]={type:"utility",url:e.id})})}catch(t){console.error("Failed to build utilities from utilitiesData:",t)}let h=null,u="~";const v={help:function(){return`
Available commands:
- help: Show this help message
- ls: List files in current directory
- cd [directory]: Navigate to directory
- cat [file]: Read file contents
- clear: Clear the terminal
- pwd: Show current directory
						`},ls:function(){return u==="~"?Object.keys(f).map(t=>t+"/").join(`
`):f[u]?Object.keys(f[u]).join(`
`):""},cd:function(t){if(!t||t===".."||t==="../")return u="~",b(),"";const e=t.replace(/\/$/,"");return f[e]?(u=e,b(),""):`cd: ${t}: No such directory`},cat:function(t){if(!t)return"Usage: cat [filename]";if(u==="github-projects"){const e=f["github-projects"][t];if(e)return window.open(e.url,"_blank"),`Opening ${t}...`}else if(u==="utilities"&&f.utilities[t])return k(t),`Loading ${t}...`;return`cat: ${t}: No such file`},pwd:function(){return u==="~"?"/root":`/root/${u}`},clear:function(){return d&&(d.innerHTML=""),""}};function D(t){if(!d)return;const e=t.trim().split(" "),l=e[0].toLowerCase(),a=e.slice(1);if(v[l]){const o=v[l](...a);o&&(d.innerHTML+='<div class="terminal-line">'+o.replace(/\n/g,"<br>")+"</div>")}else t.trim()&&(d.innerHTML+='<div class="terminal-line">Command not found: '+l+'. Type "help" for available commands.</div>');d.scrollTop=d.scrollHeight}function I(t){if(!y||!d)return t;const e=t.trim().split(/\s+/),l=y.selectionStart??t.length,a=t.substring(0,l),o=a.trim().split(/\s+/).length-1;if(o===0){const r=e[0]||"",c=Object.keys(v).filter(i=>i.startsWith(r.toLowerCase()));if(c.length===1)return c[0]+" ";if(c.length>1){let i=c[0];for(let s=1;s<c.length;s++)for(;!c[s].startsWith(i);)i=i.slice(0,-1);return i.length>r.length?i:(d.innerHTML+='<div class="terminal-line">'+c.join("  ")+"</div>",d.scrollTop=d.scrollHeight,t)}}else{const r=e[0]?.toLowerCase()||"",c=e[o]||"";let i=[];if(r==="cd"?u==="~"?i=Object.keys(f).map(s=>s+"/").filter(s=>s.startsWith(c)):f[u]&&(i=Object.keys(f[u]).filter(s=>s.startsWith(c)),"../".startsWith(c)&&i.push("../")):(r==="cat"||r==="ls")&&(u==="~"?i=Object.keys(f).map(s=>s+"/").filter(s=>s.startsWith(c)):f[u]&&(i=Object.keys(f[u]).filter(s=>s.startsWith(c)))),i.length===1){const s=a.lastIndexOf(c),m=i[0]+(i[0].endsWith("/")?"":" ");return t.substring(0,s)+m+t.substring(l)}else if(i.length>1){let s=i[0];for(let m=1;m<i.length;m++)for(;!i[m].startsWith(s);)s=s.slice(0,-1);if(s.length>c.length){const m=a.lastIndexOf(c);return t.substring(0,m)+s+t.substring(l)}else return d.innerHTML+='<div class="terminal-line">'+i.join("  ")+"</div>",d.scrollTop=d.scrollHeight,t}}return t}function S(){p=!p,p?(y.focus(),y.placeholder="Type commands here..."):(y.blur(),y.placeholder="Press ESC to focus input...")}function b(){const t=document.getElementById("prompt-dir");t&&(t.textContent=u==="~"?"~":u)}async function k(t){let e=(t||"").toString();e.toLowerCase().endsWith(".md")&&(e=e.replace(/\.md$/i,"")),h=e;const l=document.getElementById("directory-view"),a=document.getElementById("utility-view"),o=document.getElementById("utility-content");l.style.display="none",a.classList.add("active");try{let n=window.utilitiesData;if(typeof n=="string")try{n=JSON.parse(n)}catch{}if(n&&typeof n=="object"&&typeof n.serializedUtilitiesData=="string")try{n=JSON.parse(n.serializedUtilitiesData)}catch{}n&&typeof n=="object"&&Array.isArray(n.utilities)&&(n=n.utilities);let r=null;Array.isArray(n)?r=n.find(i=>{if(!i)return!1;const s=(i.id||i.slug||i.data&&i.data.id||"").toString();return s===e||s===t}):n&&typeof n=="object"&&(n[e]?r=n[e]:n[t]?r=n[t]:r=Object.values(n).find(i=>{if(!i)return!1;const s=(i.id||i.slug||i.data&&i.data.id||"").toString();return s===e||s===t}));let c=null;if(r){if(typeof r.content=="string")c=r.content;else if(typeof r.html=="string")c=r.html;else if(typeof r.body=="string")c=r.body;else if(r.render&&typeof r.render=="function")try{const i=r.render();i&&typeof i.html=="string"&&(c=i.html)}catch{}else if(r.data&&typeof r.data.content=="string")c=r.data.content;else if(r.data&&r.data.render&&typeof r.data.render=="function")try{const i=r.data.render();i&&typeof i.html=="string"&&(c=i.html)}catch{}}if(c)o.innerHTML='<div class="utility-content">'+c+"</div>",w(o);else try{const i=document.querySelector('.directory-item[data-url="'+e+'"]'),s=document.querySelector('.directory-item[data-url="'+t+'"]');let m=i||s;if(m||(m=Array.from(document.querySelectorAll(".directory-item")).find(j=>{const E=j.querySelector(".project-path");return E&&E.textContent&&E.textContent.includes(e)})),m){const g=m.querySelector(".item-content");g&&g.innerHTML&&g.innerHTML.trim()?(o.innerHTML='<div class="utility-content">'+g.innerHTML+"</div>",w(o)):o.innerHTML='<div class="terminal-line">Error: Could not load utility content for '+e+"</div>"}else o.innerHTML='<div class="terminal-line">Error: Could not load utility content for '+e+"</div>"}catch{o.innerHTML='<div class="terminal-line">Error: Could not load utility content for '+e+"</div>"}}catch{o.innerHTML='<div class="terminal-line">Error loading utility: '+e+"</div>"}}function w(t){if(!t)return;Array.from(t.querySelectorAll("pre")).forEach(function(l){if(!(l.parentElement&&l.parentElement.classList.contains("code-block-wrapper"))){var a=document.createElement("div");a.className="code-block-wrapper",l.parentNode.insertBefore(a,l),a.appendChild(l);var o=document.createElement("button");o.className="copy-btn",o.textContent="ðŸ“‹",o.addEventListener("click",function(n){n.stopPropagation();var r=l.querySelector("code"),c=r?r.textContent:l.textContent;navigator.clipboard.writeText(c).then(function(){o.textContent="âœ…",setTimeout(function(){o.textContent="ðŸ“‹"},2e3)})}),a.appendChild(o)}})}function L(){const t=document.getElementById("directory-view"),e=document.getElementById("utility-view");t.style.display="block",e.classList.remove("active"),h=null}y.addEventListener("keydown",function(t){if(t.key==="Enter"){t.preventDefault();const e=y.value;if(e.trim()){const l=u==="~"?"~":u;d.innerHTML+='<div class="terminal-line"><span class="terminal-command">[rootHytx@github.io: '+l+"]$ "+e+"</span></div>",D(e),y.value=""}}else if(t.key==="Tab"){t.preventDefault();const e=I(y.value);e!==y.value&&(y.value=e,y.selectionStart=y.selectionEnd=e.length)}}),document.addEventListener("keydown",function(t){t.key==="Escape"&&(h&&!p?L():S())}),y.focus(),d.classList.add("active"),d.innerHTML===""&&(d.innerHTML='<div class="terminal-line">'+v.help().replace(/\n/g,"<br>")+"</div>",d.scrollTop=d.scrollHeight);function T(){document.querySelectorAll(".directory-item").forEach(function(e){e.addEventListener("click",function(){const l=this.getAttribute("data-type"),a=this.getAttribute("data-url");if(l==="project"){window.open(a,"_blank");return}if(l==="utility"){const o=this.querySelector(".item-content"),n=document.getElementById("directory-view"),r=document.getElementById("utility-view"),c=document.getElementById("utility-content");o&&o.innerHTML&&o.innerHTML.trim()?(n.style.display="none",r.classList.add("active"),c.innerHTML='<div class="utility-content">'+o.innerHTML+"</div>",w(c),h=a):k(a)}})})}document.getElementById("back-button").addEventListener("click",L),document.addEventListener("keydown",function(t){if(p)return;const e=document.getElementById("utility-view");if(e&&e.classList.contains("active")){if(t.key==="ArrowDown"){t.preventDefault(),e.scrollTop+=40;return}else if(t.key==="ArrowUp"){t.preventDefault(),e.scrollTop-=40;return}else if(t.key==="PageDown"){t.preventDefault(),e.scrollTop+=e.clientHeight*.9;return}else if(t.key==="PageUp"){t.preventDefault(),e.scrollTop-=e.clientHeight*.9;return}else if(t.key==="Home"){t.preventDefault(),e.scrollTop=0;return}else if(t.key==="End"){t.preventDefault(),e.scrollTop=e.scrollHeight;return}}const l=document.querySelectorAll(".directory-item");let a=-1;if(l.forEach(function(o,n){o.classList.contains("selected")&&(a=n)}),t.key==="ArrowDown"){t.preventDefault();const o=(a+1)%l.length;l.forEach(function(n){n.classList.remove("selected")}),l[o].classList.add("selected")}else if(t.key==="ArrowUp"){t.preventDefault();const o=a<=0?l.length-1:a-1;l.forEach(function(n){n.classList.remove("selected")}),l[o].classList.add("selected")}else t.key==="Enter"&&a>=0?l[a].click():t.key==="Backspace"&&h&&L()}),y.focus(),T(),b();const H=document.querySelector(".directory-item");H&&H.classList.add("selected");const C=document.querySelectorAll(".directory-item");C.forEach(function(t){t.addEventListener("mouseenter",function(){C.forEach(function(e){e.classList.remove("selected")}),t.classList.add("selected")})})});
